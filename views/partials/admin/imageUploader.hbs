<div class="mb-3">
    <label for="imageUploader" class="form-label">Subir imagen</label>
    <input type="file" class="form-control" id="imageUploader" value="{{this}}" accept="image/*">
</div>
<div id="imagePreview" class="mb-3"></div>

<script>
    function convertToValidURL(url) {
        const encodedUrl = encodeURI(url);
        return encodedUrl;
    }
    // Get the input element and the preview element
    const imageUploader = document.getElementById('imageUploader');
    const imagePreview = document.getElementById('imagePreview');

    // Add an event listener to the input element
    imageUploader.addEventListener('change', function () {
        // Clear the existing preview
        imagePreview.innerHTML = '';

        // Get the selected file
        const file = this.files[0];

        // Create a FileReader object
        const reader = new FileReader();

        // Set up the FileReader onload event
        reader.onload = function () {
            // Create an image element
            const imageElement = document.createElement('img');
            imageElement.classList.add('img-thumbnail');
            imageElement.src = reader.result;

            // Append the image element to the preview element
            imagePreview.appendChild(imageElement);
        };

        // Read the selected file as a data URL
        reader.readAsDataURL(file);
    });

    // Fetch the image URL from the server (replace 'imageUrl' with the actual handlebars variable)
    const imageUrl = "{{this}}";
    const validUrl = convertToValidURL(imageUrl);
    console.log(validUrl)
    if (imageUrl) {
        // Create an image element for the existing image
        const existingImage = document.createElement('img');
        existingImage.classList.add('img-thumbnail');
        existingImage.src = validUrl;

        // Append the existing image element to the preview element
        imagePreview.appendChild(existingImage);
    }


</script>